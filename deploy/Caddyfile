{
  admin off
  email hello@tripsignal.ca
}

tripsignal.ca {
  encode zstd gzip

  # Basic security headers
  header {
    Strict-Transport-Security "max-age=31536000; includeSubDomains; preload"
    X-Content-Type-Options "nosniff"
    X-Frame-Options "DENY"
    Referrer-Policy "no-referrer"
  }

  # API routes go to backend
  handle /api/* {
    reverse_proxy api:8000
  }

  # Everything else goes to frontend
  handle {
    reverse_proxy frontend:3000
  }
}

www.tripsignal.ca {
  redir https://tripsignal.ca{uri} permanent
}
